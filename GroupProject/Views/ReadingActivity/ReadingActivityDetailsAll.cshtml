@model EntityLayer.Concrete.ReadingActivity
@{
    ViewData["Title"] = "ReadingActivityDetailsAll";
    Layout = "~/Views/Shared/_HomeLayout.cshtml";
}

<section id="about-video" class="about-video">
    <div class="container" data-aos="fade-up">

        <div class="row mt-5">

            <input type="hidden" id="activityId" value="@Model.ReadingActivityID" />
            <input type="hidden" id="date" value="@DateTime.Now.ToString("dd MMM yyyy")" />

            <div class="col-lg-6 video-box align-self-baseline p-3" data-aos="fade-right" data-aos-delay="100">
                <img src="@Model.ActivityImage" class="img-fluid" alt="">
                @*<a href="/Book/BookDetailsAll/@item.BookID" class=" "></a>*@
            </div>

            <div class="col-lg-6 pt-3 pt-lg-0 content mt-2 p-4" data-aos="fade-left" data-aos-delay="100">
                <h3>@Model.ActivityTitle</h3>

                <p class="mt-2">@Model.ActivityContent</p>

                <div class="row mt-3 p-3">
                    <table class="table border">
                        <tr>
                            <th>
                                <h5 style="color: #2487CE">Kitap Bilgileri</h5>
                            </th>
                            <th>
                            </th>
                        </tr>
                        <tr>
                            <td>
                                <i class="bx bx-check-double" style="color: #2487CE"></i>
                                Kitap Adı :
                            </td>
                            <td>@Model.Book.BookName</td>
                        </tr>
                        <tr>
                            <td>
                                <i class="bx bx-check-double" style="color: #2487CE"></i>
                                Kategori :
                            </td>
                            <td>@Model.Book.Category.CategoryName</td>
                        </tr>
                        <tr>
                            <td>
                                <i class="bx bx-check-double" style="color: #2487CE"></i>
                                Yazar :
                            </td>
                            <td>@Model.Book.BookAuthor</td>
                        </tr>
                        <tr>
                            <td>
                                <i class="bx bx-check-double" style="color: #2487CE"></i>
                                Yayınevi :
                            </td>
                            <td>@Model.Book.BookPublishingHouse</td>
                        </tr>
                        <tr>
                            <td>
                                <i class="bx bx-check-double" style="color: #2487CE"></i>
                                Sayfa Sayısı :
                            </td>
                            <td>@Model.Book.BookPageCount Sayfa</td>
                        </tr>
                        <tr>
                            <td>
                                <i class="bx bx-check-double" style="color: #2487CE"></i>
                                Etkinlik Başlama Tarihi: :
                            </td>
                            <td>@Model.ActivityStartDate.ToString("dd MMMM yyyy")</td>
                        </tr>
                        <tr>
                            <td>
                                <i class="bx bx-check-double" style="color: #2487CE"></i>
                                Etkinlik Başlama Tarihi: :
                            </td>
                            <td>@Model.ActivityFinishDate.ToString("dd MMMM yyyy")</td>
                        </tr>
                        <tr>
                            <td>
                                <i class="bx bx-check-double" style="color: #2487CE"></i>
                                Etkinlik Süresi :
                            </td>
                            <td>@((Model.ActivityFinishDate-Model.ActivityStartDate).Days) Gün</td>
                        </tr>
                    </table>
                    <div class="col-12">
                        @await Component.InvokeAsync("JoinButton")
                    </div>
                </div>

            </div>
            <section id="faq" class="faq section-bg">
                <div class="container" data-aos="fade-up">

                    <div class="section-title">
                        <h2>ETKİNLİK HAKKINDA</h2>
                    </div>

                    <div class="faq-list">
                        <ul>
                            <li data-aos="fade-up" data-aos-delay="100">
                                <i class="bx bx-help-circle icon-help"></i> <a data-bs-toggle="collapse" data-bs-target="#faq-list-2" class="collapse">Etkinliğin Kaçıncı Günündeyiz?<i class="bx bx-chevron-down icon-show"></i><i class="bx bx-chevron-up icon-close"></i></a>
                                <div id="faq-list-2" class="collapse show" data-bs-parent=".faq-list">
                                    <div class="row m-4 mb-1">
                                        <div class="col-sm-6">Geçen Gün: @((DateTime.Now-Model.ActivityStartDate).Days)</div>
                                        <div class="col-sm-6" style="text-align:right">Kalan Gün: @((Model.ActivityFinishDate - DateTime.Now).Days)</div>
                                    </div>
                                    <div class="progress m-4 mt-1">
                                        <div class="progress-bar" role="progressbar" style=" width: @(((DateTime.Now-Model.ActivityStartDate).Days*100) /((Model.ActivityFinishDate-Model.ActivityStartDate).Days) )%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>
                                </div>
                            </li>
                            @await Component.InvokeAsync("ActivitySubscribers")
                        </ul>
                    </div>
                </div>
            </section>
            <section id="faq" class="faq section-bg">
                <div class="container" data-aos="fade-up">

                    <div class="section-title">
                        <h2>YORUMLAR</h2>
                    </div>
                    <div class="faq-list">
                        <ul>
                            <li data-aos="fade-up" data-aos-delay="100">
                                <p style="text-align:right">01/06/2023</p>
                                <p style="color: #2487CE; font-size: 1.5rem">Kübra Dereli</p>
                                <div id="faq-list-2" class="collapse show" data-bs-parent=".faq-list">
                                    <p>Çok heyecanlı bir şekilde kitabı okumaya başladım. Bu kitabın etkinliğinin başlamasını çok istiyordum.</p>
                                </div>
                                <br />
                            </li>
                            <li data-aos="fade-up" data-aos-delay="100">
                                <p style="text-align:right">01/06/2023</p>
                                <p style="color: #2487CE; font-size: 1.5rem">Aleyna Barut</p>
                                <div id="faq-list-2" class="collapse show" data-bs-parent=".faq-list">
                                    <p>Çok da merak etmediğim bir kitaptı. Ancak bu ay seçilen kitaplar arasından en okuyabileceğim kitap buydu.</p>
                                </div>
                                <br />
                            </li>
                            <li data-aos="fade-up" data-aos-delay="100">
                                <p style="text-align:right">02/06/2023</p>
                                <p style="color: #2487CE; font-size: 1.5rem">Selin Göl</p>
                                <div id="faq-list-2" class="collapse show" data-bs-parent=".faq-list">
                                    <p>Haziran ayında bu kitabın seçilmesi için çok mesaj gönderdim ve başardım. Okumak için sabırsızlanıyorum.</p>
                                </div>
                                <br />
                            </li>
                        </ul>
                    </div>
                    <div class="container" data-aos="fade-up">
                        <div class="faq-list">
                            <div class="section-title">
                                <h2 class="mt-5">YORUM YAP</h2>
                            </div>
                            <div class="row">
                                <div class="col-lg-12">
                                    <div class="row">
                                        <div class="col-md-6 form-group mb-3">
                                            <input type="text" name="name" class="form-control" id="name" placeholder="Adınız" value="" required disabled>
                                        </div>
                                        <div class="col-md-6 form-group mb-3">
                                            <input type="text" name="name" class="form-control" id="surname" placeholder="Soyadınız" value="" required disabled>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-12">
                                    <div class="col-lg-12 mb-3">
                                        @Html.TextAreaFor(x => x.ActivityTitle, new { @class = "form-control", required = "required", placeholder = "Mesajınız ...", rows = "5" })
                                    </div>

                                    <div class="text-center">
                                        <button class="btn btn-success pr-4 pl-4 pt-2 pb-2"> <i class="fas fa-plus pr-3"></i>Yorum Ekle</button>
                                    </div>
                                </div>
                                </div>
                            </div>
                        </div>
                    </div>
            </section>
        </div>
    </div>
</section>

@section scripts{
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script>

        function katil() {
            var activityId = $("#activityId").val();
            var date = $("#date").val();
            let activity = {
                ReadingActivityID: activityId,
                DateOfRegistration: date,
                NumberOfPages: "0",
                BookReviewScore: "0",
            };
            $.ajax({
                type: "post",
                url: "/UserReadingActivity/UserJoinActivity/",
                data: activity,
                success: function (func) {
                    let result = jQuery.parseJSON(func);
                    alert("Etkinliğe katıldınız...");
                    var katilButton = document.querySelector('.btn.btn-success');

                    // Butonun içeriğini ve işaretini değiştirin
                    katilButton.innerHTML = '<i class="bx bx-check"></i> KATILIM GERÇEKLEŞTİ';

                    //faq-list-1 bu listeyi refresh yaptır.
                }



            });
        }
    </script>
}